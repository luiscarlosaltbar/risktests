<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Review of tests &mdash; Credit Risk Validation Tests 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="History" href="history.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Credit Risk Validation Tests
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Review of tests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#jeffrey-s-test">Jeffrey’s test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#concentration-of-rating-grades">Concentration of Rating Grades</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customer-migrations">Customer migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expected-loss-best-estimate-t-test">Expected Loss Best Estimate t test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-hosmer-lemeshow-chi-squared-test">The Hosmer-Lemeshow-Chi-squared test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lgd-t-test">LGD t test</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Credit Risk Validation Tests</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Review of tests</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/review.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-risktests.Jeffreys_test">
<span id="review-of-tests"></span><h1>Review of tests<a class="headerlink" href="#module-risktests.Jeffreys_test" title="Permalink to this headline"></a></h1>
<section id="jeffrey-s-test">
<h2>Jeffrey’s test<a class="headerlink" href="#jeffrey-s-test" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="risktests.Jeffreys_test.jeffreys_test">
<span class="sig-prename descclassname"><span class="pre">risktests.Jeffreys_test.</span></span><span class="sig-name descname"><span class="pre">jeffreys_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratings_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PDs_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defaults_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/risktests/Jeffreys_test.html#jeffreys_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#risktests.Jeffreys_test.jeffreys_test" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>array-like</em><em>, </em><em>at least 2D</em>) – data</p></li>
<li><p><strong>ratings_col</strong> (<em>string</em>) – name of column with ratings</p></li>
<li><p><strong>PDs_col</strong> (<em>string</em>) – name of column with probabilities-of-default values</p></li>
<li><p><strong>defaults_col</strong> (<em>string</em>) – name of column with default statuses</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – level of significance</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – if true, results and interpretation are printed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – dataframe with p-value for each rating and other statistics</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>7D array-like object</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Observations are assumed to be independent.
This fundtion can be used for both performing and non-performing LGDs.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;sample_data.xlsx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outpput</span> <span class="o">=</span> <span class="n">jeffreys_test</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ratings_col</span><span class="o">=</span><span class="s1">&#39;ratings&#39;</span><span class="p">,</span> <span class="n">PDs_col</span><span class="o">=</span><span class="s1">&#39;PD&#39;</span><span class="p">,</span> <span class="n">defaults_col</span><span class="o">=</span><span class="s1">&#39;loan_status&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<span class="target" id="module-risktests.Concentration_of_Rating_Grades"></span><section id="concentration-of-rating-grades">
<h2>Concentration of Rating Grades<a class="headerlink" href="#concentration-of-rating-grades" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="risktests.Concentration_of_Rating_Grades.ratings_concentration">
<span class="sig-prename descclassname"><span class="pre">risktests.Concentration_of_Rating_Grades.</span></span><span class="sig-name descname"><span class="pre">ratings_concentration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_ratings_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_ratings_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/risktests/Concentration_of_Rating_Grades.html#ratings_concentration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#risktests.Concentration_of_Rating_Grades.ratings_concentration" title="Permalink to this definition"></a></dt>
<dd><p>test for the meaningful dispersion of the rating grades</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>array-like</em><em>, </em><em>at least 2D</em>) – data</p></li>
<li><p><strong>initial_ratings_col</strong> (<em>string</em>) – name of column with initial ratings</p></li>
<li><p><strong>final_ratings_col</strong> (<em>string</em>) – name of column with final ratings</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>H_init</strong> (<em>float</em>) – Initial Herfindahl index</p></li>
<li><p><strong>H_curr</strong> (<em>float</em>) – Final Herfindahl index</p></li>
<li><p><strong>p_value</strong> (<em>float</em>) – p-value of the test</p></li>
<li><p><strong>N</strong> (<em>integer</em>) – Number of customers or facilities</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Observations are assumed to be independent.
This function can be used for both performing and non-performing LGDs.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">ratings_concentration</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">initial_ratings_col</span><span class="o">=</span><span class="s1">&#39;ratings&#39;</span><span class="p">,</span> <span class="n">final_ratings_col</span><span class="o">=</span><span class="s1">&#39;ratings2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<span class="target" id="module-risktests.Customer_migrations"></span><section id="customer-migrations">
<h2>Customer migrations<a class="headerlink" href="#customer-migrations" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="risktests.Customer_migrations.migration_matrix_statistics">
<span class="sig-prename descclassname"><span class="pre">risktests.Customer_migrations.</span></span><span class="sig-name descname"><span class="pre">migration_matrix_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_ratings_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_ratings_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/risktests/Customer_migrations.html#migration_matrix_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#risktests.Customer_migrations.migration_matrix_statistics" title="Permalink to this definition"></a></dt>
<dd><p>Calculates statistics that summarise the upgrades and downgrades of ratings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>array-like</em><em>, </em><em>at least 2D</em>) – data</p></li>
<li><p><strong>initial_ratings_col</strong> (<em>string</em>) – name of column with observed LGD values</p></li>
<li><p><strong>final_ratings_col</strong> (<em>string</em>) – name of column with expected LGD values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>upper_mwb</strong> (<em>float</em>) – upper matrix weighted bandwidth</p></li>
<li><p><strong>lower_mwb</strong> (<em>float</em>) – lower matrix weighted bandwidth</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">migration_matrix_statistics</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">initial_ratings_col</span><span class="o">=</span><span class="s1">&#39;ratings&#39;</span><span class="p">,</span> <span class="n">final_ratings_col</span><span class="o">=</span><span class="s1">&#39;ratings2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<span class="target" id="module-risktests.Expected_Loss_Best_Estimate_t_test"></span><section id="expected-loss-best-estimate-t-test">
<h2>Expected Loss Best Estimate t test<a class="headerlink" href="#expected-loss-best-estimate-t-test" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="risktests.Expected_Loss_Best_Estimate_t_test.elbe_t_test">
<span class="sig-prename descclassname"><span class="pre">risktests.Expected_Loss_Best_Estimate_t_test.</span></span><span class="sig-name descname"><span class="pre">elbe_t_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LGD_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ELBE_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/risktests/Expected_Loss_Best_Estimate_t_test.html#elbe_t_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#risktests.Expected_Loss_Best_Estimate_t_test.elbe_t_test" title="Permalink to this definition"></a></dt>
<dd><p>t-test of Null hypothesis that ELBE is equal to realised LGD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>array-like</em><em>, </em><em>at least 2D</em>) – data</p></li>
<li><p><strong>LGD_col</strong> (<em>string</em>) – name of column with LGD values</p></li>
<li><p><strong>ELBE_col</strong> (<em>string</em>) – name of column with ELBE values</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – if true, results and interpretation are printed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>N</strong> (<em>integer</em>) – Number of customers</p></li>
<li><p><strong>LGD.mean</strong> (<em>float</em>) – Mean value of LGD</p></li>
<li><p><strong>ELBE.mean</strong> (<em>float</em>) – Mean value of ELBE</p></li>
<li><p><strong>t_stat</strong> (<em>float</em>) – test statistic</p></li>
<li><p><strong>s2</strong> (<em>float</em>) – denominator of test statistic</p></li>
<li><p><strong>p_value</strong> (<em>float</em>) – p-value of the test</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Observations are assumed to be independent.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">elbe_t_test</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">LGD_col</span><span class="o">=</span><span class="s1">&#39;LGD&#39;</span><span class="p">,</span> <span class="n">ELBE_col</span><span class="o">=</span><span class="s1">&#39;ELBE&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<span class="target" id="module-risktests.Hosmer_Lemeshow_Chi_Square"></span><section id="the-hosmer-lemeshow-chi-squared-test">
<h2>The Hosmer-Lemeshow-Chi-squared test<a class="headerlink" href="#the-hosmer-lemeshow-chi-squared-test" title="Permalink to this headline"></a></h2>
<blockquote>
<div><p>Created on 2022-06-08</p>
<p>Author: Anton Treialt
License: BSD(3-clause)</p>
<p>This test measures the squared difference between forecasted and observed defaults on bucket level.</p>
<dl class="simple">
<dt>The null hypotheisis makes two assumptions:</dt><dd><p>-That the  forecasted default probabilities and the observed default rates are identically distributed, and;
-that the defaults are independent.</p>
</dd>
</dl>
<p>According to Blochwitz et al. (2006), under the assumptions the test statistic converges to a chi-square distribution with B-2 degrees of
freedom if N (the number of observations) goes to infinity. Here B is the number of credit buckets.</p>
<dl class="simple">
<dt>The hypotheses are:</dt><dd><p>H0: The observed number of defaults is equal to the predicted number of defaults
H1: The number of predicted and observed defaults are unequal.</p>
</dd>
</dl>
<p>According to Tasche(2006), this test has several drawbacks. Firstly, for buckets with low number of facilities, there might be bad approximations.
Second, independence between facilities (borrowers) is assumed which can be justified using a point-in-time approach. Thirdly, the model makes no
distinction between deviations that are conservative or optimisitc even though they have different impact.Furthermore, the composed model test assumes
independence, but does take into account the difference between conservative and optimistic deviations.</p>
<dl class="simple">
<dt>1.Blochwitz, S., Martin, M. R. W., &amp; Wehn, C. S. (2006). Statistical Approaches to PD Validation.</dt><dd><dl class="simple">
<dt>In B. Engelmann &amp; R. Rauhmeier (Eds.), The Basel II Risk Parameters: Estimation, Validation, and Stress Testing</dt><dd><p>(pp. 289–306). Springer. <a class="reference external" href="https://doi.org/10.1007/3-540-33087-9_13">https://doi.org/10.1007/3-540-33087-9_13</a></p>
</dd>
</dl>
</dd>
<dt>2.Tasche, D. (2006). Validation of internal rating systems and PD estimates (arXiv:physics/0606071).</dt><dd><p>arXiv. <a class="reference external" href="http://arxiv.org/abs/physics/0606071">http://arxiv.org/abs/physics/0606071</a></p>
</dd>
</dl>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="risktests.Hosmer_Lemeshow_Chi_Square.Hosmer_Lemeshow_Chi_Square">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">risktests.Hosmer_Lemeshow_Chi_Square.</span></span><span class="sig-name descname"><span class="pre">Hosmer_Lemeshow_Chi_Square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buckets_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loan_statuses_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PDs_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/risktests/Hosmer_Lemeshow_Chi_Square.html#Hosmer_Lemeshow_Chi_Square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#risktests.Hosmer_Lemeshow_Chi_Square.Hosmer_Lemeshow_Chi_Square" title="Permalink to this definition"></a></dt>
<dd><p>Performs the Hosmer-Lemeshow Chi-Square test to validate credit data given the loan buckets, loan statuses and probabilitities of default.</p>
<p>Assumes at least a 3D dataframe or 3D array-like dataset is passed to the arguement ‘data’ but requires the buckets column, loan status column and probability-of-default column names to be
passed to the corresponding arguments.</p>
<p>If verbose is set to True, the test results and interpretation will be printed, the default is False.</p>
<p>alpha must be set otherwise a TypeError is raised.
:param
data : array_like, 3-D of higher
buckets_col : name of column with buckets
loan_status_col : name of column with loan statuses
PDs_col : name of column with probabilities-of-default
alpha: the tests level of significance. either 1%, 5% or 10%
verbose: boolean. Prints the results if true.
:return
data: data passed into the function call
bucket_levels: unique buckets in the data
HLC_stat: Hosmer-Lemeshow test statistic
alpha: the test’s significance level
p_value: the test’s p-value
verbose: boolean passed to function call to print results or not.
critical_value: the critical value of the test
dof: the test’s degrees of freedom</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Hosmer_Lemeshow_Chi_Square</span> <span class="k">as</span> <span class="nn">HLC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sampling the buckets randomly at fixed probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buckets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bucket one&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket two&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket three&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket four&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket five&quot;</span><span class="p">],</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loan_status</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;non-default&quot;</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">buckets</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket one&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket two&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket three&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket four&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket five&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">loan_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;loan_bucket&#39;</span><span class="p">:</span> <span class="n">buckets</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="s1">&#39;loan_status&#39;</span><span class="p">:</span> <span class="n">loan_status</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="s1">&#39;PD&#39;</span><span class="p">:</span> <span class="n">probs</span><span class="p">})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">HLC</span><span class="o">.</span><span class="n">Hosmer_Lemeshow_Chi_Square</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">loan_data</span><span class="p">,</span> <span class="n">buckets_col</span><span class="o">=</span><span class="s1">&#39;loan_bucket&#39;</span><span class="p">,</span> <span class="n">loan_statuses_col</span><span class="o">=</span><span class="s1">&#39;loan_status&#39;</span><span class="p">,</span> <span class="n">PDs_col</span><span class="o">=</span><span class="s1">&#39;PD&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">HLC_stat</span> <span class="c1"># Shows the Hower-Lemeshow statistic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">p_value</span> <span class="c1"># Shows the p-value</span>
</pre></div>
</div>
</dd></dl>

</section>
<span class="target" id="module-risktests.LGD_t_test"></span><section id="lgd-t-test">
<h2>LGD t test<a class="headerlink" href="#lgd-t-test" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="risktests.LGD_t_test.lgd_t_test">
<span class="sig-prename descclassname"><span class="pre">risktests.LGD_t_test.</span></span><span class="sig-name descname"><span class="pre">lgd_t_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_LGD_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_LGD_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/risktests/LGD_t_test.html#lgd_t_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#risktests.LGD_t_test.lgd_t_test" title="Permalink to this definition"></a></dt>
<dd><p>t-test for the Null hypothesis that estimated LGD is greater than true LGD</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>array-like</em><em>, </em><em>at least 2D</em>) – data</p></li>
<li><p><strong>observed_LGD_col</strong> (<em>string</em>) – name of column with observed LGD values</p></li>
<li><p><strong>expected_LGD_col</strong> (<em>string</em>) – name of column with expected LGD values</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – if true, results and interpretation are printed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>N</strong> (<em>integer</em>) – Number of customers</p></li>
<li><p><strong>LGD.mean</strong> (<em>float</em>) – Mean value of observed LGD values</p></li>
<li><p><strong>pred_LGD.mean</strong> (<em>float</em>) – Mean value of predicted LGD values</p></li>
<li><p><strong>t_stat</strong> (<em>float</em>) – test statistic</p></li>
<li><p><strong>lgd_s2</strong> (<em>float</em>) – denominator of test statistic</p></li>
<li><p><strong>p_value</strong> (<em>float</em>) – p-value of the test</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Observations are assumed to be independent.
This fundtion can be used for both performing and non-performing LGDs.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">lgd_t_test</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">observed_LGD_col</span><span class="o">=</span><span class="s1">&#39;LGD&#39;</span><span class="p">,</span> <span class="n">expected_LGD_col</span><span class="o">=</span><span class="s1">&#39;PRED_LGD&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="history.html" class="btn btn-neutral float-left" title="History" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Anton Treialt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>