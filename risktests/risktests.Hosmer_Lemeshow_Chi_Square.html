<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hosmer Lemeshow Chi Square &mdash; Credit Risk Validation Tests 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Jeffreys test" href="risktests.Jeffreys_test.html" />
    <link rel="prev" title="Expected Loss Best Estimate t test" href="risktests.Expected_Loss_Best_Estimate_t_test.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Credit Risk Validation Tests
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="risktests.html">Review of tests</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="risktests.Concentration_of_Rating_Grades.html">Concentration of Rating Grades</a></li>
<li class="toctree-l2"><a class="reference internal" href="risktests.Customer_migrations.html">Customer migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="risktests.Expected_Loss_Best_Estimate_t_test.html">Expected Loss Best Estimate t test</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hosmer Lemeshow Chi Square</a></li>
<li class="toctree-l2"><a class="reference internal" href="risktests.Jeffreys_test.html">Jeffreys test</a></li>
<li class="toctree-l2"><a class="reference internal" href="risktests.LGD_t_test.html">LGD t test</a></li>
<li class="toctree-l2"><a class="reference internal" href="risktests.Stability_of_Migration_Matrices.html">Stability of Migration Matrices</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Credit Risk Validation Tests</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="risktests.html">Review of tests</a> &raquo;</li>
      <li>Hosmer Lemeshow Chi Square</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/risktests/risktests.Hosmer_Lemeshow_Chi_Square.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-risktests.Hosmer_Lemeshow_Chi_Square">
<span id="hosmer-lemeshow-chi-square"></span><h1>Hosmer Lemeshow Chi Square<a class="headerlink" href="#module-risktests.Hosmer_Lemeshow_Chi_Square" title="Permalink to this headline"></a></h1>
<p>Created on 2022-06-08</p>
<p>Author: Anton Treialt
License: BSD(3-clause)</p>
<p class="rubric">Notes</p>
<p>This test measures the squared difference between forecasted and observed defaults on bucket level.</p>
<dl class="simple">
<dt>The null hypotheisis makes two assumptions:</dt><dd><p>-That the  forecasted default probabilities and the observed default rates are identically distributed, and;
-that the defaults are independent.</p>
</dd>
</dl>
<p>According to Blochwitz et al. (2006), under the assumptions the test statistic converges to a chi-square distribution with B-2 degrees of
freedom if N (the number of observations) goes to infinity. Here B is the number of credit buckets.</p>
<dl class="simple">
<dt>The hypotheses are:</dt><dd><p>H0: The observed number of defaults is equal to the predicted number of defaults
H1: The number of predicted and observed defaults are unequal.</p>
</dd>
</dl>
<p>According to Tasche(2006), this test has several drawbacks. Firstly, for buckets with low number of facilities, there might be bad approximations.
Second, independence between facilities (borrowers) is assumed which can be justified using a point-in-time approach. Thirdly, the model makes no
distinction between deviations that are conservative or optimisitc even though they have different impact.Furthermore, the composed model test assumes
independence, but does take into account the difference between conservative and optimistic deviations.</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>1.Blochwitz, S., Martin, M. R. W., &amp; Wehn, C. S. (2006). Statistical Approaches to PD Validation.</dt><dd><dl class="simple">
<dt>In B. Engelmann &amp; R. Rauhmeier (Eds.), The Basel II Risk Parameters: Estimation, Validation, and Stress Testing</dt><dd><p>(pp. 289–306). Springer. <a class="reference external" href="https://doi.org/10.1007/3-540-33087-9_13">https://doi.org/10.1007/3-540-33087-9_13</a></p>
</dd>
</dl>
</dd>
<dt>2.Tasche, D. (2006). Validation of internal rating systems and PD estimates (arXiv:physics/0606071).</dt><dd><p>arXiv. <a class="reference external" href="http://arxiv.org/abs/physics/0606071">http://arxiv.org/abs/physics/0606071</a></p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="risktests.Hosmer_Lemeshow_Chi_Square.Hosmer_Lemeshow_Chi_Square">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">risktests.Hosmer_Lemeshow_Chi_Square.</span></span><span class="sig-name descname"><span class="pre">Hosmer_Lemeshow_Chi_Square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buckets_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loan_statuses_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PDs_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/risktests/Hosmer_Lemeshow_Chi_Square.html#Hosmer_Lemeshow_Chi_Square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#risktests.Hosmer_Lemeshow_Chi_Square.Hosmer_Lemeshow_Chi_Square" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Performs the Hosmer-Lemeshow Chi-Square test to validate credit data given the loan buckets, loan statuses and probabilitities of default.</p>
<p>Assumes at least a 3D dataframe or 3D array-like dataset is passed to the arguement ‘data’ but requires the buckets column, loan status column and probability-of-default column names to be
passed to the corresponding arguments.</p>
<p>If verbose is set to True, the test results and interpretation will be printed, the default is False.</p>
<p>alpha must be set otherwise a TypeError is raised.
:param
data : array_like, 3-D of higher
buckets_col : name of column with buckets
loan_status_col : name of column with loan statuses
PDs_col : name of column with probabilities-of-default
alpha: the tests level of significance. either 1%, 5% or 10%
verbose: boolean. Prints the results if true.
:return
data: data passed into the function call
bucket_levels: unique buckets in the data
HLC_stat: Hosmer-Lemeshow test statistic
alpha: the test’s significance level
p_value: the test’s p-value
verbose: boolean passed to function call to print results or not.
critical_value: the critical value of the test
dof: the test’s degrees of freedom</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Hosmer_Lemeshow_Chi_Square</span> <span class="k">as</span> <span class="nn">HLC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sampling the buckets randomly at fixed probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buckets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bucket one&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket two&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket three&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket four&quot;</span><span class="p">,</span><span class="s2">&quot;Bucket five&quot;</span><span class="p">],</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loan_status</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;non-default&quot;</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">buckets</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket one&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket two&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket three&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket four&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">elif</span> <span class="n">buckets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bucket five&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">loan_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;loan_bucket&#39;</span><span class="p">:</span> <span class="n">buckets</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="s1">&#39;loan_status&#39;</span><span class="p">:</span> <span class="n">loan_status</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="s1">&#39;PD&#39;</span><span class="p">:</span> <span class="n">probs</span><span class="p">})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">HLC</span><span class="o">.</span><span class="n">Hosmer_Lemeshow_Chi_Square</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">loan_data</span><span class="p">,</span> <span class="n">buckets_col</span><span class="o">=</span><span class="s1">&#39;loan_bucket&#39;</span><span class="p">,</span> <span class="n">loan_statuses_col</span><span class="o">=</span><span class="s1">&#39;loan_status&#39;</span><span class="p">,</span> <span class="n">PDs_col</span><span class="o">=</span><span class="s1">&#39;PD&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">HLC_stat</span> <span class="c1"># Shows the Hower-Lemeshow statistic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">p_value</span> <span class="c1"># Shows the p-value</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="risktests.Expected_Loss_Best_Estimate_t_test.html" class="btn btn-neutral float-left" title="Expected Loss Best Estimate t test" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="risktests.Jeffreys_test.html" class="btn btn-neutral float-right" title="Jeffreys test" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Anton Treialt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>